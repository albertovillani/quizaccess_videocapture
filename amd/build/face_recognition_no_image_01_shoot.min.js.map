{"version":3,"file":"face_recognition_no_image_01_shoot.min.js","sources":["../src/face_recognition_no_image_01_shoot.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manage the acquisition of a new profile picture via the webcam.\n *\n * @module     quizaccess_videocapture/face_recognition_no_image_01_shoot\n * @author     Alberto Villani <alberto.villani@abacotechnology.it>\n * @copyright  2022 Abaco Technology\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/modal_factory', 'core/modal_events', 'core/templates',\n'core/ajax', 'quizaccess_videocapture/face_recognition_client'],\n function($, ModalFactory, ModalEvents, Templates, ajax, RC) {\n\n    var uid = null;\n\n    return{\n        init: function(userid){\n\n            uid = userid;\n            RC.setFlow('shoot');\n            RC.setUid(uid);\n            RC.setPhotoTarget('photo_target');\n\n            document.getElementById('video').addEventListener('canplay', function(){\n                $('#recogloader').show();\n                $('.shot_container').show();\n                $('button[name=\"takepicture\"]').show();\n            });\n\n            RC.startVideoCap('video', 'canvas', 'photo');\n\n\n            $('button[name=\"takepicture\"]').on('click', function(e){\n                e.preventDefault();\n                RC.setStep(0);\n                $('#capturedpicture').show();\n                $('.icon_container').show();\n                $('#capturedmessage').show();\n                $('.errmsg').hide();\n                $('#capturederror').hide();\n                $('.shot_container').hide();\n                $('#recogfailed').hide();\n                $('#recogsuccess').hide();\n                $('button[name=\"saveandlogin\"]').hide();\n                 $('#slhelp').hide();\n                RC.takepicture();\n            });\n\n            $('button[name=\"saveandlogin\"]').on('click', function(e){\n                e.preventDefault();\n                $('#recogfailed').hide();\n                $('#svl-bio-err').show();\n                $('#svl-api-error').hide();\n                $('#recogsuccess').hide();\n                $('#slhelp').hide();\n                $('#videocheck').show();\n                $('#recogloader').show();\n                RC.saveandlogin();\n            });\n\n            $('button[name=\"backbtn\"]').on('click', function(e){\n                e.preventDefault();\n                RC.releaseStream();\n                $('.videocappreflight #container01').remove();\n                $('#container00').show();\n\n            });\n\n            $('input[name=\"cancel\"]').on('click', () => {\n                $('.videocappreflight #container01').remove();\n                $('.preflighttitle').show();\n                $('#fitem_id_startvideocap').show();\n                $('.videocappreflight').hide();\n                $('input[name=\"submitbutton\"]').attr('disabled', 'disabled');\n                RC.releaseStream();\n            });\n\n            document.addEventListener('newpictureCheckSuccess', () =>{\n                RC.setStep(1);\n                $('.icon_container').hide();\n                $('.shot_container').show();\n                $('#photo_target').show();\n                $('#slhelp').show();\n                $('button[name=\"saveandlogin\"]').show();\n            });\n\n            document.addEventListener('newpictureCheckFailed', (e) =>{\n                RC.setStep(0);\n                $('#capturedmessage').hide();\n                if(e.detail.remote_error){\n                    $('#errormsg-BIO-API-ERR').show();\n                }else{\n                    $('#errormsg-'+e.detail.msgcod).show();\n                }\n                $('#capturederror').show();\n            });\n\n            document.addEventListener('saveandloginCheckSuccess', () =>{\n                $('#recogfailed').hide();\n                $('#recogloader').hide();\n                $('.actionbtn').attr('disabled', true);\n                $('input[name=\"facematched\"]').attr('value', '1');\n                $('input[name=\"submitbutton\"]').removeAttr('disabled');\n                $('#recogsuccess').show();\n\n            });\n\n            document.addEventListener('saveandloginCheckFailed', (e) =>{\n                $('#recogsuccess').hide();\n                $('#recogloader').hide();\n                if(e.detail.remote_error){\n                    $('#svl-bio-err').hide();\n                    $('#svl-api-error').show();\n                }\n                $('#recogfailed').show();\n            });\n\n        }\n    };\n\n});"],"names":["define","$","ModalFactory","ModalEvents","Templates","ajax","RC","uid","init","userid","setFlow","setUid","setPhotoTarget","document","getElementById","addEventListener","show","startVideoCap","on","e","preventDefault","setStep","hide","takepicture","saveandlogin","releaseStream","remove","attr","detail","remote_error","msgcod","removeAttr"],"mappings":";;;;;;;;AAwBAA,oEAAO,CAAC,SAAU,qBAAsB,oBAAqB,iBAC7D,YAAa,oDACZ,SAASC,EAAGC,aAAcC,YAAaC,UAAWC,KAAMC,QAEjDC,IAAM,WAEJ,CACFC,KAAM,SAASC,QAEXF,IAAME,OACNH,GAAGI,QAAQ,SACXJ,GAAGK,OAAOJ,KACVD,GAAGM,eAAe,gBAElBC,SAASC,eAAe,SAASC,iBAAiB,WAAW,WACzDd,EAAE,gBAAgBe,OAClBf,EAAE,mBAAmBe,OACrBf,EAAE,8BAA8Be,UAGpCV,GAAGW,cAAc,QAAS,SAAU,SAGpChB,EAAE,8BAA8BiB,GAAG,SAAS,SAASC,GACjDA,EAAEC,iBACFd,GAAGe,QAAQ,GACXpB,EAAE,oBAAoBe,OACtBf,EAAE,mBAAmBe,OACrBf,EAAE,oBAAoBe,OACtBf,EAAE,WAAWqB,OACbrB,EAAE,kBAAkBqB,OACpBrB,EAAE,mBAAmBqB,OACrBrB,EAAE,gBAAgBqB,OAClBrB,EAAE,iBAAiBqB,OACnBrB,EAAE,+BAA+BqB,OAChCrB,EAAE,WAAWqB,OACdhB,GAAGiB,iBAGPtB,EAAE,+BAA+BiB,GAAG,SAAS,SAASC,GAClDA,EAAEC,iBACFnB,EAAE,gBAAgBqB,OAClBrB,EAAE,gBAAgBe,OAClBf,EAAE,kBAAkBqB,OACpBrB,EAAE,iBAAiBqB,OACnBrB,EAAE,WAAWqB,OACbrB,EAAE,eAAee,OACjBf,EAAE,gBAAgBe,OAClBV,GAAGkB,kBAGPvB,EAAE,0BAA0BiB,GAAG,SAAS,SAASC,GAC7CA,EAAEC,iBACFd,GAAGmB,gBACHxB,EAAE,mCAAmCyB,SACrCzB,EAAE,gBAAgBe,UAItBf,EAAE,wBAAwBiB,GAAG,SAAS,KAClCjB,EAAE,mCAAmCyB,SACrCzB,EAAE,mBAAmBe,OACrBf,EAAE,2BAA2Be,OAC7Bf,EAAE,sBAAsBqB,OACxBrB,EAAE,8BAA8B0B,KAAK,WAAY,YACjDrB,GAAGmB,mBAGPZ,SAASE,iBAAiB,0BAA0B,KAChDT,GAAGe,QAAQ,GACXpB,EAAE,mBAAmBqB,OACrBrB,EAAE,mBAAmBe,OACrBf,EAAE,iBAAiBe,OACnBf,EAAE,WAAWe,OACbf,EAAE,+BAA+Be,UAGrCH,SAASE,iBAAiB,yBAA0BI,IAChDb,GAAGe,QAAQ,GACXpB,EAAE,oBAAoBqB,OACnBH,EAAES,OAAOC,aACR5B,EAAE,yBAAyBe,OAE3Bf,EAAE,aAAakB,EAAES,OAAOE,QAAQd,OAEpCf,EAAE,kBAAkBe,UAGxBH,SAASE,iBAAiB,4BAA4B,KAClDd,EAAE,gBAAgBqB,OAClBrB,EAAE,gBAAgBqB,OAClBrB,EAAE,cAAc0B,KAAK,YAAY,GACjC1B,EAAE,6BAA6B0B,KAAK,QAAS,KAC7C1B,EAAE,8BAA8B8B,WAAW,YAC3C9B,EAAE,iBAAiBe,UAIvBH,SAASE,iBAAiB,2BAA4BI,IAClDlB,EAAE,iBAAiBqB,OACnBrB,EAAE,gBAAgBqB,OACfH,EAAES,OAAOC,eACR5B,EAAE,gBAAgBqB,OAClBrB,EAAE,kBAAkBe,QAExBf,EAAE,gBAAgBe"}